<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cat√°logo Aquenio - Resplandor y Bienestar</title>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="header">
    <img src="Aquenio-logo-pq.png" alt="Logo de Aquenio" class="logo"> 
    <h1>Comienza tu resplandor con Aquenio</h1>
    <p>Pijamas, Maquillaje y Joyer√≠a: Donde el descanso se encuentra con la belleza y el estilo.</p>
  </header>

  <div class="category-tabs" id="category-tabs"></div>
  <main class="catalogue-grid" id="catalogue-grid"></main>

  <script>
    const SHEET_JSON_URL = "üîó Pega aqu√≠ tu nueva URL /exec despu√©s de desplegar"; 
    const WHATSAPP_BASE_URL = 'https://wa.me/584129878696'; 
    const catalogueGrid = document.getElementById('catalogue-grid');
    const categoryTabsContainer = document.getElementById('category-tabs');

    async function fetchAndRenderCatalogue() {
      try {
        const response = await fetch(SHEET_JSON_URL);
        if (!response.ok) throw new Error(`Error HTTP ${response.status}`);

        const products = await response.json();
        if (!Array.isArray(products) || products.length === 0) {
          throw new Error("La API devolvi√≥ datos vac√≠os.");
        }

        const categories = getUniqueCategories(products);
        renderCategoryTabs(categories, products);
        renderProducts(products);
      } catch (error) {
        catalogueGrid.innerHTML = `<p style="grid-column: 1 / -1; text-align:center; padding: 50px 0; color: red; font-weight: 700;">
          ‚ùå ERROR: No se pudo cargar el cat√°logo.<br>${error.message}</p>`;
      }
    }

    function getUniqueCategories(products) {
      const categories = new Set(products.map(p => p.Categoria).filter(c => c && c.trim() !== ''));
      return ['TODOS', ...Array.from(categories)];
    }

    function renderCategoryTabs(categories, products) {
      categoryTabsContainer.innerHTML = '';
      categories.forEach(category => {
        const button = document.createElement('button');
        button.className = 'tab-button';
        button.textContent = category.toUpperCase();
        button.dataset.category = category;

        button.addEventListener('click', () => {
          document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          const filtered = category === 'TODOS'
            ? products
            : products.filter(p => p.Categoria.toUpperCase() === category.toUpperCase());
          renderProducts(filtered);
        });
        categoryTabsContainer.appendChild(button);
      });
      categoryTabsContainer.querySelector('[data-category="TODOS"]').classList.add('active');
    }

    function renderProducts(products) {
      catalogueGrid.innerHTML = '';
      if (products.length === 0) {
        catalogueGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align:center;">No hay productos.</p>';
        return;
      }

      products.forEach(product => {
        const isAvailable = product.Stock > 0;
        const whatsappText = `Hola, me interesa "${product.Nombre_Producto}" (C√≥digo: ${product.Codigo}).`;
        const whatsappLink = `${WHATSAPP_BASE_URL}?text=${encodeURIComponent(whatsappText)}`;

        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <img src="${product.Foto_URL}" alt="${product.Nombre_Producto}" class="product-image" loading="lazy">
          <div class="product-details">
            <h3>${product.Nombre_Producto}</h3>
            <p>${product.Categoria}</p>
            <p>C√≥d: ${product.Codigo}</p>
            <p>${product.Descripcion}</p>
            <p>$${Number(product.Precio).toLocaleString('es-VE', { minimumFractionDigits: 2 })}</p>
            <p>${isAvailable ? `Disponible: ${product.Stock} uds.` : "Agotado"}</p>
            ${isAvailable 
              ? `<a href="${whatsappLink}" target="_blank"><button class="whatsapp-button">Comprar por WhatsApp</button></a>`
              : `<button class="whatsapp-button" disabled>Agotado</button>`}
          </div>
        `;
        catalogueGrid.appendChild(card);
      });
    }

    fetchAndRenderCatalogue();
  </script>
</body>
</html>
